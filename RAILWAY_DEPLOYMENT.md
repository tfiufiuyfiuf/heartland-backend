# ğŸš€ Railway éƒ¨ç½²æŒ‡å—

## ğŸ“‹ è¿ç§»è¯´æ˜

ç”±äº Vercel çš„ serverless éƒ¨ç½²æ–¹å¼ä¸ Express CORS ä¸­é—´ä»¶å­˜åœ¨å…¼å®¹æ€§é—®é¢˜ï¼Œæˆ‘ä»¬å°†åç«¯è¿ç§»åˆ° Railwayã€‚Railway æ”¯æŒä¼ ç»Ÿçš„ Node.js éƒ¨ç½²ï¼Œä¸ä¼šæœ‰ CORS é—®é¢˜ã€‚

---

## âœ… å·²å®Œæˆçš„å‡†å¤‡å·¥ä½œ

1. âœ… ç§»é™¤äº† Vercel ç‰¹å®šé…ç½®
2. âœ… æ›´æ–°æœåŠ¡å™¨ç›‘å¬åœ°å€ä¸º `0.0.0.0`ï¼ˆRailway è¦æ±‚ï¼‰
3. âœ… åˆ›å»ºäº† `Procfile` æ–‡ä»¶
4. âœ… åˆ›å»ºäº† `.railwayignore` æ–‡ä»¶
5. âœ… ä¿®å¤äº†è·¯ç”±å¯¼å…¥é—®é¢˜

---

## ğŸŒ éƒ¨ç½²æ­¥éª¤

### ç¬¬ä¸€æ­¥ï¼šæ³¨å†Œ Railway è´¦å·

1. è®¿é—® [Railway.app](https://railway.app)
2. ç‚¹å‡» **"Start a New Project"** æˆ– **"Login"**
3. ä½¿ç”¨ GitHub è´¦å·ç™»å½•ï¼ˆæ¨èï¼‰

### ç¬¬äºŒæ­¥ï¼šåˆ›å»ºæ–°é¡¹ç›®

#### æ–¹å¼ Aï¼šä» GitHub éƒ¨ç½²ï¼ˆæ¨èï¼‰

1. åœ¨ Railway æ§åˆ¶å°ï¼Œç‚¹å‡» **"New Project"**
2. é€‰æ‹© **"Deploy from GitHub repo"**
3. æˆæƒ Railway è®¿é—®ä½ çš„ GitHub
4. é€‰æ‹©åŒ…å«åç«¯ä»£ç çš„ä»“åº“
5. Railway ä¼šè‡ªåŠ¨æ£€æµ‹åˆ° Node.js é¡¹ç›®

#### æ–¹å¼ Bï¼šä½¿ç”¨ Railway CLI éƒ¨ç½²

```powershell
# å®‰è£… Railway CLI
npm install -g @railway/cli

# ç™»å½•
railway login

# è¿›å…¥åç«¯ç›®å½•
cd backend

# åˆå§‹åŒ–é¡¹ç›®
railway init

# éƒ¨ç½²
railway up
```

### ç¬¬ä¸‰æ­¥ï¼šé…ç½®ç¯å¢ƒå˜é‡

åœ¨ Railway é¡¹ç›®ä¸­æ·»åŠ ä»¥ä¸‹ç¯å¢ƒå˜é‡ï¼š

1. åœ¨é¡¹ç›®é¡µé¢ï¼Œç‚¹å‡» **"Variables"** æ ‡ç­¾
2. æ·»åŠ ä»¥ä¸‹å˜é‡ï¼š

```bash
# æ•°æ®åº“é…ç½®
SUPABASE_URL=https://your-project.supabase.co
SUPABASE_ANON_KEY=your-anon-key-here
SUPABASE_SERVICE_KEY=your-service-key-here

# JWT é…ç½®
JWT_SECRET=your-32-character-secret-key-here
JWT_EXPIRE=7d

# æœåŠ¡å™¨é…ç½®
NODE_ENV=production
PORT=3000

# å‰ç«¯åœ°å€ï¼ˆç”¨äº CORSï¼‰
FRONTEND_URL=https://heartland-webapp.vercel.app
```

**é‡è¦æç¤º**ï¼š
- ä» Vercel åç«¯é¡¹ç›®å¤åˆ¶è¿™äº›ç¯å¢ƒå˜é‡çš„å€¼
- åœ¨ Vercel é¡¹ç›®è®¾ç½®ä¸­æ‰¾åˆ°ï¼šSettings > Environment Variables

### ç¬¬å››æ­¥ï¼šéƒ¨ç½²

1. Railway ä¼šè‡ªåŠ¨æ£€æµ‹ `package.json` å’Œ `Procfile`
2. ç‚¹å‡» **"Deploy"** æŒ‰é’®
3. ç­‰å¾…éƒ¨ç½²å®Œæˆï¼ˆé€šå¸¸éœ€è¦ 2-3 åˆ†é’Ÿï¼‰

### ç¬¬äº”æ­¥ï¼šè·å–ç”Ÿäº§ URL

1. éƒ¨ç½²å®Œæˆåï¼Œç‚¹å‡» **"Settings"** æ ‡ç­¾
2. æ‰¾åˆ° **"Domains"** éƒ¨åˆ†
3. ç‚¹å‡» **"Generate Domain"**
4. Railway ä¼šæä¾›ä¸€ä¸ªç±»ä¼¼ `https://your-app.railway.app` çš„ URL
5. ä¹Ÿå¯ä»¥ç»‘å®šè‡ªå®šä¹‰åŸŸå

---

## ğŸ”§ æ›´æ–°å‰ç«¯é…ç½®

éƒ¨ç½²å®Œæˆåï¼Œéœ€è¦æ›´æ–°å‰ç«¯çš„ API åœ°å€ï¼š

### 1. æ›´æ–°å‰ç«¯é…ç½®æ–‡ä»¶

ç¼–è¾‘ `heartland-webapp/frontend/config.js`ï¼š

```javascript
const CONFIG = {
  API: {
    BASE_URL: 'https://your-app.railway.app'  // æ›¿æ¢ä¸ºä½ çš„ Railway URL
  },
  // ... å…¶ä»–é…ç½®ä¿æŒä¸å˜
};
```

### 2. é‡æ–°éƒ¨ç½²å‰ç«¯åˆ° Vercel

```powershell
cd heartland-webapp
vercel --prod
```

---

## ğŸ§ª æµ‹è¯•éƒ¨ç½²

### 1. æµ‹è¯•å¥åº·æ£€æŸ¥

```powershell
# æ›¿æ¢ä¸ºä½ çš„ Railway URL
curl https://your-app.railway.app/health
```

åº”è¯¥è¿”å›ï¼š
```json
{
  "status": "ok",
  "timestamp": "2024-...",
  "uptime": 123.45,
  "environment": "production"
}
```

### 2. æµ‹è¯• CORS

åœ¨æµè§ˆå™¨ä¸­è®¿é—®å‰ç«¯ï¼Œå°è¯•æ³¨å†Œ/ç™»å½•ï¼š
1. è®¿é—® `https://heartland-webapp.vercel.app/student-login.html`
2. æ‰“å¼€å¼€å‘è€…å·¥å…·ï¼ˆF12ï¼‰
3. å°è¯•æ³¨å†Œæˆ–ç™»å½•
4. æ£€æŸ¥ Network æ ‡ç­¾ï¼Œç¡®è®¤æ²¡æœ‰ CORS é”™è¯¯

### 3. æµ‹è¯• API ç«¯ç‚¹

```powershell
# æµ‹è¯•æ³¨å†Œ
curl -X POST https://your-app.railway.app/api/auth/register \
  -H "Content-Type: application/json" \
  -d '{"username":"test123","password":"123456","role":"student"}'

# æµ‹è¯•ç™»å½•
curl -X POST https://your-app.railway.app/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{"username":"test123","password":"123456"}'
```

---

## ğŸ“Š ç›‘æ§å’Œæ—¥å¿—

### æŸ¥çœ‹æ—¥å¿—

åœ¨ Railway æ§åˆ¶å°ï¼š
1. ç‚¹å‡»ä½ çš„æœåŠ¡
2. ç‚¹å‡» **"Deployments"** æ ‡ç­¾
3. ç‚¹å‡»æœ€æ–°çš„éƒ¨ç½²
4. æŸ¥çœ‹å®æ—¶æ—¥å¿—

### æŸ¥çœ‹æŒ‡æ ‡

åœ¨ **"Metrics"** æ ‡ç­¾ä¸­å¯ä»¥çœ‹åˆ°ï¼š
- CPU ä½¿ç”¨ç‡
- å†…å­˜ä½¿ç”¨ç‡
- è¯·æ±‚æ•°é‡
- å“åº”æ—¶é—´

---

## ğŸ¯ Railway ä¼˜åŠ¿

âœ… **æ—  CORS é—®é¢˜**ï¼šæ”¯æŒä¼ ç»Ÿ Node.js éƒ¨ç½²  
âœ… **è‡ªåŠ¨ HTTPS**ï¼šå…è´¹ SSL è¯ä¹¦  
âœ… **å®æ—¶æ—¥å¿—**ï¼šæ–¹ä¾¿è°ƒè¯•  
âœ… **è‡ªåŠ¨é‡å¯**ï¼šæœåŠ¡å´©æºƒæ—¶è‡ªåŠ¨æ¢å¤  
âœ… **ç¯å¢ƒå˜é‡ç®¡ç†**ï¼šç®€å•æ˜“ç”¨  
âœ… **å…è´¹é¢åº¦**ï¼šæ¯æœˆ $5 å…è´¹é¢åº¦  
âœ… **å¿«é€Ÿéƒ¨ç½²**ï¼šGitHub æ¨é€è‡ªåŠ¨éƒ¨ç½²  

---

## ğŸ’° è´¹ç”¨è¯´æ˜

Railway é‡‡ç”¨æŒ‰ä½¿ç”¨é‡è®¡è´¹ï¼š
- **å…è´¹é¢åº¦**ï¼šæ¯æœˆ $5 å…è´¹é¢åº¦
- **æ”¶è´¹æ ‡å‡†**ï¼š
  - CPUï¼š$0.000463/åˆ†é’Ÿ
  - å†…å­˜ï¼š$0.000231/GB/åˆ†é’Ÿ
  - ç½‘ç»œï¼šå‰ 100GB å…è´¹

**é¢„ä¼°è´¹ç”¨**ï¼ˆå°å‹åº”ç”¨ï¼‰ï¼š
- å¦‚æœåº”ç”¨è¿è¡Œæ­£å¸¸ï¼Œæ¯æœˆè´¹ç”¨çº¦ $3-5
- å…è´¹é¢åº¦è¶³å¤Ÿæµ‹è¯•å’Œå°è§„æ¨¡ä½¿ç”¨

---

## ğŸ”„ CI/CD è‡ªåŠ¨éƒ¨ç½²

### è®¾ç½® GitHub è‡ªåŠ¨éƒ¨ç½²

1. ç¡®ä¿é¡¹ç›®ä»£ç æ¨é€åˆ° GitHub
2. åœ¨ Railway ä¸­è¿æ¥ GitHub ä»“åº“
3. å¯ç”¨è‡ªåŠ¨éƒ¨ç½²ï¼š
   - Settings > Service Settings
   - å‹¾é€‰ **"Auto-deploy on push"**

ç°åœ¨ï¼Œæ¯æ¬¡æ¨é€ä»£ç åˆ° GitHubï¼ŒRailway ä¼šè‡ªåŠ¨éƒ¨ç½²ï¼

---

## ğŸ†š Railway vs Vercel

| ç‰¹æ€§ | Railway | Vercel |
|------|---------|---------|
| Node.js æ”¯æŒ | âœ… å®Œæ•´æ”¯æŒ | âš ï¸ Serverless é™åˆ¶ |
| CORS | âœ… å®Œç¾æ”¯æŒ | âŒ ç»å¸¸æœ‰é—®é¢˜ |
| WebSocket | âœ… æ”¯æŒ | âŒ ä¸æ”¯æŒ |
| é•¿è¿æ¥ | âœ… æ”¯æŒ | âŒ æœ‰æ—¶é—´é™åˆ¶ |
| éƒ¨ç½²é€Ÿåº¦ | âš¡ å¿« | âš¡ å¿« |
| å…è´¹é¢åº¦ | $5/æœˆ | æœ‰é™çš„è¯·æ±‚æ•° |

---

## â“ å¸¸è§é—®é¢˜

### Q1: éƒ¨ç½²å¤±è´¥æ€ä¹ˆåŠï¼Ÿ

**A**: æ£€æŸ¥éƒ¨ç½²æ—¥å¿—ï¼š
1. ç‚¹å‡»å¤±è´¥çš„éƒ¨ç½²
2. æŸ¥çœ‹æ—¥å¿—ä¸­çš„é”™è¯¯ä¿¡æ¯
3. é€šå¸¸æ˜¯ç¯å¢ƒå˜é‡æœªé…ç½®æˆ–ä»£ç é”™è¯¯

### Q2: æ•°æ®åº“è¿æ¥å¤±è´¥ï¼Ÿ

**A**: æ£€æŸ¥ç¯å¢ƒå˜é‡ï¼š
1. ç¡®è®¤ `SUPABASE_URL` å’Œ `SUPABASE_SERVICE_KEY` å·²é…ç½®
2. åœ¨ Railway æ—¥å¿—ä¸­æŸ¥çœ‹ "æ•°æ®åº“è¿æ¥å¤±è´¥" é”™è¯¯
3. æµ‹è¯• Supabase æ˜¯å¦å¯è®¿é—®

### Q3: å¦‚ä½•å›æ»šåˆ°ä¹‹å‰çš„ç‰ˆæœ¬ï¼Ÿ

**A**: 
1. åœ¨ Deployments æ ‡ç­¾ä¸­
2. æ‰¾åˆ°ä¹‹å‰æˆåŠŸçš„éƒ¨ç½²
3. ç‚¹å‡» **"Redeploy"**

### Q4: å¦‚ä½•æ·»åŠ è‡ªå®šä¹‰åŸŸåï¼Ÿ

**A**:
1. Settings > Domains
2. ç‚¹å‡» **"Custom Domain"**
3. è¾“å…¥ä½ çš„åŸŸåï¼ˆå¦‚ `api.yourdomain.com`ï¼‰
4. æŒ‰ç…§æç¤ºé…ç½® DNS è®°å½•

### Q5: å¯ä»¥ä½¿ç”¨æ•°æ®åº“å—ï¼Ÿ

**A**: Railway è¿˜æä¾›æ•°æ®åº“æœåŠ¡ï¼š
- PostgreSQL
- MySQL
- MongoDB
- Redis

ä½†æˆ‘ä»¬å·²ç»ä½¿ç”¨ Supabaseï¼Œä¸éœ€è¦ Railway æ•°æ®åº“ã€‚

---

## ğŸ“ è·å–å¸®åŠ©

- **Railway æ–‡æ¡£**: [docs.railway.app](https://docs.railway.app)
- **Railway Discord**: [discord.gg/railway](https://discord.gg/railway)
- **GitHub Issues**: é¡¹ç›®é‡åˆ°é—®é¢˜å¯ä»¥åœ¨ä»“åº“åˆ›å»º issue

---

## ğŸ‰ å®Œæˆï¼

æŒ‰ç…§ä»¥ä¸Šæ­¥éª¤ï¼Œä½ çš„åç«¯åº”è¯¥å·²ç»æˆåŠŸéƒ¨ç½²åˆ° Railwayï¼

**ä¸‹ä¸€æ­¥**ï¼š
1. âœ… æµ‹è¯•æ‰€æœ‰ API ç«¯ç‚¹
2. âœ… æ›´æ–°å‰ç«¯é…ç½®
3. âœ… æµ‹è¯•å®Œæ•´çš„ç”¨æˆ·æµç¨‹
4. âœ… åˆ é™¤ Vercel åç«¯é¡¹ç›®ï¼ˆå¯é€‰ï¼‰

**æ­å–œï¼CORS é—®é¢˜åº”è¯¥å½»åº•è§£å†³äº†ï¼** ğŸŠ

