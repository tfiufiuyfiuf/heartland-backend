# 分院测试升级说明

## 升级内容

### 1. 更难的题目（15道）
- 题目更模糊，需要深度思考
- 选项更难预测，无法通过"一直选A"来进入特定学院
- 每道题的选项顺序会随机打乱

### 2. 防作弊机制
- **选项随机打乱**：每次加载测试时，每道题的选项顺序都会随机打乱
- **唯一标识符**：每个选项使用唯一ID，而不是简单的索引
- **无法预测**：即使知道正确答案，也无法通过固定模式选择来作弊

## 升级步骤

### 步骤1：在 Supabase 中执行新的SQL脚本

1. 打开 Supabase Dashboard：https://supabase.com/dashboard
2. 选择你的项目
3. 点击左侧菜单 **"SQL Editor"**
4. 点击 **"New query"**
5. 打开文件：`backend/config/sorting-reset-hard.sql`
6. 复制所有内容并粘贴到 SQL Editor
7. 点击 **"Run"** 或按 `Ctrl + Enter`
8. 验证结果：应该显示 `total_questions: 15`

### 步骤2：等待后端部署

- Render 会自动部署（约 2-3 分钟）
- 在 Render Dashboard 查看状态，等待显示 **"Live"**

### 步骤3：重新部署前端

使用 Netlify Drop 重新上传前端文件，或等待 Git 自动部署。

## 测试验证

1. 清除浏览器缓存（`Ctrl + Shift + Delete`）
2. 访问测试页面
3. 刷新页面多次，观察选项顺序是否变化
4. 尝试通过"一直选第一个选项"来测试防作弊功能

## 技术细节

### 选项打乱机制

1. **后端生成唯一ID**：基于题目ID、原始索引和选项文本生成唯一标识符
2. **Fisher-Yates洗牌算法**：使用标准洗牌算法随机打乱选项顺序
3. **前端使用唯一ID**：提交答案时使用唯一ID而非索引
4. **后端匹配**：根据唯一ID重新计算并匹配到原始选项

### 题目难度升级

- **旧题目**：选项特征明显（如"勇敢表达观点"明显指向格兰芬多）
- **新题目**：更模糊、需要深度思考（如"角落的位置"可能指向不同学院）
- **难度等级**：从 2-3 级提升到 3-4 级

## 注意事项

- 旧的测试结果不受影响
- 已完成的用户不能重新测试（除非重置数据库）
- 选项打乱是每次请求时进行的，刷新页面会看到不同的顺序

